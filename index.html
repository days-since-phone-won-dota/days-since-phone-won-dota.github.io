<!DOCTYPE html>
<html>
<head>
  <title>Phone's Latest Dota2 Stats</title>
  <link rel="stylesheet" type="text/css" href="css/styles.css">
</head>
<body>
  <div class="stats-container">
    <h2>Phone's Lastest Dota 2 Stats</h2>
    <div class="card">
        <div class="card-header">Number of games Phone has lost since his last win</div>
        <div class="card-content" id="games-since-last-win"></div>
    </div>

    <div class="card">
        <div class="card-header">Hours/Days since phone's last win</div>
        <div class="card-content" id="hours-since-last-win"></div>
    </div>

    <div class="card">
        <div class="card-header">Phone's winrate over his past 20 games</div>
        <div class="card-content" id="last-20-games-stats"></div>
    </div>
  </div>


  <script src="js/script.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', async () => {
      const loadingOverlay = document.getElementById('loadingOverlay');
      const showLoading = () => {
        loadingOverlay.classList.add('active');
      };
      const hideLoading = () => {
        loadingOverlay.classList.remove('active');
      };
      try {
        showLoading();
        await getLastXGames();
        const number_of_games_since_last_win = numberOfGamesSinceLastWin();
        const hours_since_last_win = hoursSinceLastWin();
        const number_of_wins_past_x_games = numberOfWinsPastXGames();

        // Games Since Last Win Card
        const gamesCardContent = document.getElementById('games-since-last-win');
        if (number_of_games_since_last_win === 0) {
            gamesCardContent.innerHTML = 
                '<span class="trophy">üèÜ PHONE WON HIS LAST GAME POGGERS ! üèÜ</span>';
        } else {
            gamesCardContent.innerHTML = 
                `<span class="skull">‚ò†Ô∏è ${number_of_games_since_last_win}</span>`;
        }

        // Hours Since Last Win Card
        const hoursCardContent = document.getElementById('hours-since-last-win');
        if (hours_since_last_win <= 24) {
            hoursCardContent.innerHTML = 
                `<span class="skull">‚ò†Ô∏è${hours_since_last_win} hours</span>`;
        } else {
            const days_since_last_win = Math.round(hours_since_last_win / 24);
            hoursCardContent.innerHTML = 
                `<span class="skull">‚ò†Ô∏è${days_since_last_win} days</span>`;
        }

        // Last 20 Games Stats Card
        document.getElementById('last-20-games-stats').innerHTML = 
            `<span class="skull">‚ò†Ô∏è ${number_of_wins_past_x_games} / 20</span>`;

        hideLoading();
      } catch (error) {
        console.error('Failed to get stats:', error);
      }
    });
  </script>
<div class="loading-overlay" id="loadingOverlay">
  <img src="https://pbs.twimg.com/profile_images/497185789550149633/5e0Do4hY_400x400.jpeg" 
       alt="Loading" 
       class="loading-image">
</div>
</body>
</html>